from chuva_vazao_utils.calendar import query
from chuva_vazao_utils.connection import RiverDatabase
from chuva_vazao_utils.utils.cacheutils import timed_lru_cache


@timed_lru_cache(seconds=300)
def fetch_calendar(year, calendar_type):
    cursor = RiverDatabase.execute(query.SQL_CALENDAR, params={
        "year": year,
        "next_year": year + 1,
        "calendar_type": calendar_type
    })
    return cursor.fetchall()
