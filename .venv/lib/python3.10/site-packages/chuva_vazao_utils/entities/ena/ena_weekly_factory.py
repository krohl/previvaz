from typing import List

from chuva_vazao_utils.entities.ena.ena import Ena
from chuva_vazao_utils.entities.ena.ena_weekly import EnaWeekly
from chuva_vazao_utils.entities.operative_week import SemanaOperativaFactory


class WeeklyEnaFactory:

    @classmethod
    def get_weekly_mean(cls, ena_list: List[Ena]) -> List[EnaWeekly]:
        return [
            EnaWeekly(
                power_plant=ena.power_plant,
                origin=ena.origin,
                inflow_source=ena.inflow_source,
                id_rodada_smap=ena.id_rodada_smap,
                op_week=SemanaOperativaFactory.create_from_date(ena.time),
                value=ena.value,
            )
            for ena in ena_list
        ]
