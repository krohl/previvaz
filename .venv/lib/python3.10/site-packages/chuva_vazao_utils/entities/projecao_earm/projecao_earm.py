from abc import ABC, abstractmethod
from typing import List, Union, Optional
from datetime import date
from dataclasses import dataclass

from chuva_vazao_utils.entities.inflow.origin_type import OriginType
from chuva_vazao_utils.entities.subsystem.subsytem import Subsystem


@dataclass
class ProjecaoEarm:
    date: date
    origin: OriginType
    subsistema: Subsystem
    delta_final: Optional[float] = None
    delta_final_perc: Optional[float] = None
    earm_final_perc: Optional[float] = None
    id_rodada_smap: Optional[int] = None


class ProjecaoEarmApi(ABC):
    @classmethod
    @abstractmethod
    def persist(cls, projecao_earm_vals: Union[ProjecaoEarm, List[ProjecaoEarm]], auto_commit: bool = True):
        raise NotImplementedError()
