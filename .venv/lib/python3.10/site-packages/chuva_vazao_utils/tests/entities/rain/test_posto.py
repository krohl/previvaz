from unittest.mock import Mock
from chuva_vazao_utils.entities.rain.posto import PostoApi


def test_fetch_by_lat_long():
    # Given
    mock_posto = Mock(latitude=1., longitude=2.)

    class PostoTestApi(PostoApi):
        @classmethod
        def fetch_all(cls):
            return [
                mock_posto,
                Mock(latitude=2., longitude=4.)
            ]
    # When
    posto = PostoTestApi.fetch_by_lat_long(1., 2.)
    # Then
    assert posto == mock_posto

    # When/Then
    assert PostoTestApi.fetch_by_lat_long(1., 4.) is None
