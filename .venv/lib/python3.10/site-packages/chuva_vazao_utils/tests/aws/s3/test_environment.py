import pytest

from chuva_vazao_utils.aws.s3.environment import Env
from chuva_vazao_utils.aws.s3.exception import EnvNotSet


def test_set_env():
    cur_env = Env.environment
    # Given
    Env.set_custom_environment('teste')
    # When/Then
    assert 'teste' in Env.bucket_smap
    # Given
    Env.reset_custom_environment()
    # When/Then
    with pytest.raises(EnvNotSet):
        Env.environment
    # Given
    Env.set_custom_environment('teste2')
    # When/Then
    assert 'teste2' in Env.bucket_smap

    # Voltando à configuração original
    Env.set_custom_environment(cur_env)
