from chuva_vazao_utils.database_access.query_formatter import NOT_NULL


def test_not_null_expression():
    assert 'IS NOT NULL' == NOT_NULL


def test_format_string(formatter):
    expected = ' test IS NOT NULL '
    result = formatter.format(column='test', condition=NOT_NULL, values_select=[1])

    assert result == expected


def test_format_string_with_value(formatter):
    expected = ' test = %s '
    result = formatter.format(column='test', condition='test_condition', values_select=[1])

    assert result == expected


def test_format_null_values(formatter):
    expected = ' test IS NULL '
    result = formatter.format(column='test', condition=None, values_select=[1])

    assert result == expected
