from chuva_vazao_utils.calculator import query
from chuva_vazao_utils.connection import RiverDatabase
from chuva_vazao_utils.utils.cacheutils import timed_lru_cache


@timed_lru_cache(seconds=300)
def fetch_coefficients():
    cursor = RiverDatabase.execute(query.REGRESSION_COEFFICIENT_QUERY)
    return cursor.fetchall()


@timed_lru_cache(seconds=300)
def fetch_productivity():
    cursor = RiverDatabase.execute(query.PRODUCTIVITY_QUERY)
    return cursor.fetchall()


@timed_lru_cache(seconds=300)
def fetch_subsystems():
    cursor = RiverDatabase.execute(query.SUBSYSTEMS_QUERY)
    return cursor.fetchall()
